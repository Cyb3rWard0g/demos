SHOW PROPERTIES;
SHOW TOPICS;
CREATE STREAM WINLOGBEAT_STREAM (source_name VARCHAR, type VARCHAR, task VARCHAR, log_name VARCHAR, computer_name VARCHAR, event_data STRUCT< UtcTime VARCHAR, ProcessGuid VARCHAR, ProcessId INTEGER, Image VARCHAR, FileVersion VARCHAR, Description VARCHAR, Product VARCHAR, Company VARCHAR, CommandLine VARCHAR, CurrentDirectory VARCHAR, User VARCHAR, LogonGuid VARCHAR, LogonId VARCHAR, TerminalSessionId INTEGER, IntegrityLevel VARCHAR, Hashes VARCHAR, ParentProcessGuid VARCHAR, ParentProcessId INTEGER, ParentImage VARCHAR, ParentCommandLine VARCHAR>, event_id INTEGER) WITH (KAFKA_TOPIC='winlogbeat', VALUE_FORMAT='JSON');
SELECT S.COMPUTER_NAME, S.EVENT_DATA->PROCESSGUID , S.EVENT_DATA->IMAGE FROM WINLOGBEAT_STREAM S WHERE S.SOURCE_NAME='Microsoft-Windows-Sysmon' AND S.EVENT_ID=1 LIMIT 5;
SELECT S.COMPUTER_NAME, S.EVENT_DATA->PROCESSGUID , S.EVENT_DATA->IMAGE FROM WINLOGBEAT_STREAM S WHERE S.SOURCE_NAME='Microsoft-Windows-Sysmon' AND S.EVENT_ID=1 AND S.EVENT_DATA->IMAGE LIKE '%Rubeus%' LIMIT 4;
SELECT S.COMPUTER_NAME, S.EVENT_DATA->PROCESSGUID , S.EVENT_DATA->IMAGE , S.EVENT_DATA->COMMANDLINE FROM WINLOGBEAT_STREAM S WHERE S.SOURCE_NAME='Microsoft-Windows-Sysmon' AND S.EVENT_ID=1 AND S.EVENT_DATA->IMAGE LIKE '%Rubeus%' LIMIT 4;